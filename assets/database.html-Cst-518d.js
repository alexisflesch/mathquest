import{_ as n,c as a,a as e,o as t}from"./app-DoDG4mLI.js";const p={};function i(l,s){return t(),a("div",null,s[0]||(s[0]=[e(`<h1 id="base-de-donnees" tabindex="-1"><a class="header-anchor" href="#base-de-donnees"><span>Base de données</span></a></h1><h2 id="schema-general" tabindex="-1"><a class="header-anchor" href="#schema-general"><span>Schéma général</span></a></h2><p>MathQuest utilise PostgreSQL comme base de données principale avec Prisma comme ORM. Le schéma est organisé autour de plusieurs entités principales interconnectées.</p><h2 id="modeles-principaux" tabindex="-1"><a class="header-anchor" href="#modeles-principaux"><span>Modèles principaux</span></a></h2><h3 id="user-utilisateur" tabindex="-1"><a class="header-anchor" href="#user-utilisateur"><span>User (Utilisateur)</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line">model <span class="token keyword">User</span> {</span>
<span class="line">  id                              String            <span class="token variable">@id</span> <span class="token variable">@default</span><span class="token punctuation">(</span>uuid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">  username                        String</span>
<span class="line">  email                           String?           <span class="token variable">@unique</span></span>
<span class="line">  passwordHash                    String?</span>
<span class="line">  createdAt                       <span class="token keyword">DateTime</span>          <span class="token variable">@default</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">  role                            UserRole</span>
<span class="line">  resetToken                      String?           <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;reset_token&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  resetTokenExpiresAt             <span class="token keyword">DateTime</span>?         <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;reset_token_expires_at&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  avatarEmoji                     String?</span>
<span class="line">  emailVerificationToken          String?           <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;email_verification_token&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  emailVerificationTokenExpiresAt <span class="token keyword">DateTime</span>?         <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;email_verification_token_expires_at&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  emailVerified                   <span class="token keyword">Boolean</span>?          <span class="token variable">@default</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;email_verified&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  studentProfile                  StudentProfile?</span>
<span class="line">  teacherProfile                  TeacherProfile?</span>
<span class="line">  initiatedGameInstances          GameInstance<span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token variable">@relation</span><span class="token punctuation">(</span><span class="token string">&quot;InitiatedGameInstancesByUser&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  gameParticipations              GameParticipant<span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">  createdGameTemplates            GameTemplate<span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token variable">@relation</span><span class="token punctuation">(</span><span class="token string">&quot;UserCreatedGameTemplates&quot;</span><span class="token punctuation">)</span></span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Rôles disponibles :</strong></p><ul><li><code>STUDENT</code> : Élève</li><li><code>TEACHER</code> : Professeur</li><li><code>GUEST</code> : Invité (sans compte)</li></ul><h3 id="question-question" tabindex="-1"><a class="header-anchor" href="#question-question"><span>Question (Question)</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line">model Question {</span>
<span class="line">  uid                    String                    <span class="token variable">@id</span> <span class="token variable">@default</span><span class="token punctuation">(</span>uuid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">  title                  String?</span>
<span class="line">  <span class="token keyword">text</span>                   String                    <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;question_text&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  questionType           String                    <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;question_type&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  discipline             String</span>
<span class="line">  themes                 String<span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">  difficulty             <span class="token keyword">Int</span>?</span>
<span class="line">  gradeLevel             String?                   <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;grade_level&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  author                 String?</span>
<span class="line">  explanation            String?</span>
<span class="line">  tags                   String<span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">  timeLimit              <span class="token keyword">Int</span>                       <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;time_limit_seconds&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  excludedFrom           String<span class="token punctuation">[</span><span class="token punctuation">]</span>                  <span class="token variable">@default</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;excluded_from&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  createdAt              <span class="token keyword">DateTime</span>                  <span class="token variable">@default</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;created_at&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  updatedAt              <span class="token keyword">DateTime</span>                  <span class="token variable">@updatedAt</span> <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;updated_at&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  feedbackWaitTime       <span class="token keyword">Int</span>?</span>
<span class="line">  isHidden               <span class="token keyword">Boolean</span>?                  <span class="token variable">@default</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;is_hidden&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  multipleChoiceQuestion MultipleChoiceQuestion?</span>
<span class="line">  numericQuestion        NumericQuestion?</span>
<span class="line">  gameTemplates          QuestionsInGameTemplate<span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Types de questions :</strong></p><ul><li><strong>QCM (Multiple Choice)</strong> : Questions à choix multiples avec réponses partielles possibles</li><li><strong>Numérique</strong> : Questions nécessitant une réponse numérique avec tolérance</li></ul><h3 id="multiplechoicequestion" tabindex="-1"><a class="header-anchor" href="#multiplechoicequestion"><span>MultipleChoiceQuestion</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line">model MultipleChoiceQuestion {</span>
<span class="line">  questionUid    String    <span class="token variable">@id</span> <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;question_uid&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  answerOptions  String<span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;answer_options&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  correctAnswers <span class="token keyword">Boolean</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;correct_answers&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  question       Question  <span class="token variable">@relation</span><span class="token punctuation">(</span><span class="token keyword">fields</span>: <span class="token punctuation">[</span>questionUid<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">references</span>: <span class="token punctuation">[</span>uid<span class="token punctuation">]</span><span class="token punctuation">,</span> onDelete: <span class="token keyword">Cascade</span><span class="token punctuation">)</span></span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Exemple :</strong></p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code class="language-json"><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">&quot;questionUid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;q-123&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;answerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;Paris&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Lyon&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Marseille&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Toulouse&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;correctAnswers&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="numericquestion" tabindex="-1"><a class="header-anchor" href="#numericquestion"><span>NumericQuestion</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line">model NumericQuestion {</span>
<span class="line">  questionUid   String   <span class="token variable">@id</span> <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;question_uid&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  correctAnswer <span class="token keyword">Float</span>    <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;correct_answer&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  tolerance     <span class="token keyword">Float</span>?   <span class="token variable">@default</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;tolerance&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  unit          String?  <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;unit&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  question      Question <span class="token variable">@relation</span><span class="token punctuation">(</span><span class="token keyword">fields</span>: <span class="token punctuation">[</span>questionUid<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">references</span>: <span class="token punctuation">[</span>uid<span class="token punctuation">]</span><span class="token punctuation">,</span> onDelete: <span class="token keyword">Cascade</span><span class="token punctuation">)</span></span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Exemple :</strong></p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code class="language-json"><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">&quot;questionUid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;q-456&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;correctAnswer&quot;</span><span class="token operator">:</span> <span class="token number">3.14159</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;tolerance&quot;</span><span class="token operator">:</span> <span class="token number">0.01</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;unit&quot;</span><span class="token operator">:</span> <span class="token string">&quot;m²&quot;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="gametemplate-modele-de-jeu" tabindex="-1"><a class="header-anchor" href="#gametemplate-modele-de-jeu"><span>GameTemplate (Modèle de jeu)</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line">model GameTemplate {</span>
<span class="line">  id            String                    <span class="token variable">@id</span> <span class="token variable">@default</span><span class="token punctuation">(</span>uuid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">  name          String</span>
<span class="line">  gradeLevel    String?                   <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;grade_level&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  themes        String<span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">  discipline    String?</span>
<span class="line">  description   String?</span>
<span class="line">  defaultMode   PlayMode?                 <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;default_mode&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  createdAt     <span class="token keyword">DateTime</span>                  <span class="token variable">@default</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;created_at&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  updatedAt     <span class="token keyword">DateTime</span>                  <span class="token variable">@updatedAt</span> <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;updated_at&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  creatorId     String                    <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;creator_id&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  gameInstances GameInstance<span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">  creator       <span class="token keyword">User</span>                      <span class="token variable">@relation</span><span class="token punctuation">(</span><span class="token string">&quot;UserCreatedGameTemplates&quot;</span><span class="token punctuation">,</span> <span class="token keyword">fields</span>: <span class="token punctuation">[</span>creatorId<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">references</span>: <span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">  questions     QuestionsInGameTemplate<span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Modes de jeu :</strong></p><ul><li><code>quiz</code> : Quiz classique en temps réel</li><li><code>tournament</code> : Tournoi avec système de score avancé</li><li><code>practice</code> : Mode entraînement sans timer</li><li><code>class</code> : Mode classe pour utilisation en salle</li></ul><h3 id="questionsingametemplate-questions-dans-un-modele" tabindex="-1"><a class="header-anchor" href="#questionsingametemplate-questions-dans-un-modele"><span>QuestionsInGameTemplate (Questions dans un modèle)</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line">model QuestionsInGameTemplate {</span>
<span class="line">  gameTemplateId String       <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;game_template_id&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  questionUid    String       <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;question_uid&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  sequence       <span class="token keyword">Int</span></span>
<span class="line">  createdAt      <span class="token keyword">DateTime</span>     <span class="token variable">@default</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;created_at&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  gameTemplate   GameTemplate <span class="token variable">@relation</span><span class="token punctuation">(</span><span class="token keyword">fields</span>: <span class="token punctuation">[</span>gameTemplateId<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">references</span>: <span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">,</span> onDelete: <span class="token keyword">Cascade</span><span class="token punctuation">)</span></span>
<span class="line">  question       Question     <span class="token variable">@relation</span><span class="token punctuation">(</span><span class="token keyword">fields</span>: <span class="token punctuation">[</span>questionUid<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">references</span>: <span class="token punctuation">[</span>uid<span class="token punctuation">]</span><span class="token punctuation">,</span> onDelete: <span class="token keyword">Cascade</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">  @<span class="token variable">@id</span><span class="token punctuation">(</span><span class="token punctuation">[</span>gameTemplateId<span class="token punctuation">,</span> sequence<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">  @<span class="token variable">@unique</span><span class="token punctuation">(</span><span class="token punctuation">[</span>gameTemplateId<span class="token punctuation">,</span> questionUid<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="gameinstance-instance-de-jeu" tabindex="-1"><a class="header-anchor" href="#gameinstance-instance-de-jeu"><span>GameInstance (Instance de jeu)</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line">model GameInstance {</span>
<span class="line">  id                    String            <span class="token variable">@id</span> <span class="token variable">@default</span><span class="token punctuation">(</span>uuid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">  name                  String</span>
<span class="line">  accessCode            String            <span class="token variable">@unique</span> <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;access_code&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">status</span>                String</span>
<span class="line">  playMode              PlayMode          <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;play_mode&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  leaderboard           Json?</span>
<span class="line">  currentQuestionIndex  <span class="token keyword">Int</span>?              <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;current_question_index&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  settings              Json?</span>
<span class="line">  createdAt             <span class="token keyword">DateTime</span>          <span class="token variable">@default</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;created_at&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  startedAt             <span class="token keyword">DateTime</span>?         <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;started_at&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  endedAt               <span class="token keyword">DateTime</span>?         <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;ended_at&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  differedAvailableFrom <span class="token keyword">DateTime</span>?         <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;differed_available_from&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  differedAvailableTo   <span class="token keyword">DateTime</span>?         <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;differed_available_to&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  gameTemplateId        String            <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;game_template_id&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  initiatorUserId       String?           <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;initiator_user_id&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  gameTemplate          GameTemplate      <span class="token variable">@relation</span><span class="token punctuation">(</span><span class="token keyword">fields</span>: <span class="token punctuation">[</span>gameTemplateId<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">references</span>: <span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">  initiatorUser         <span class="token keyword">User</span>?             <span class="token variable">@relation</span><span class="token punctuation">(</span><span class="token string">&quot;InitiatedGameInstancesByUser&quot;</span><span class="token punctuation">,</span> <span class="token keyword">fields</span>: <span class="token punctuation">[</span>initiatorUserId<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">references</span>: <span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">  participants          GameParticipant<span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>États possibles :</strong></p><ul><li><code>waiting</code> : En attente de participants</li><li><code>active</code> : Partie en cours</li><li><code>completed</code> : Partie terminée</li><li><code>cancelled</code> : Partie annulée</li></ul><h3 id="gameparticipant-participant" tabindex="-1"><a class="header-anchor" href="#gameparticipant-participant"><span>GameParticipant (Participant)</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line">model GameParticipant {</span>
<span class="line">  id             String            <span class="token variable">@id</span> <span class="token variable">@default</span><span class="token punctuation">(</span>uuid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">  gameInstanceId String            <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;game_instance_id&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  userId         String            <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;user_id&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  liveScore      <span class="token keyword">Int</span>               <span class="token variable">@default</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;live_score&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  deferredScore  <span class="token keyword">Int</span>               <span class="token variable">@default</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;deferred_score&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  nbAttempts     <span class="token keyword">Int</span>               <span class="token variable">@default</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;nb_attempts&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">status</span>         ParticipantStatus <span class="token variable">@default</span><span class="token punctuation">(</span>PENDING<span class="token punctuation">)</span> <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;status&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  joinedAt       <span class="token keyword">DateTime</span>          <span class="token variable">@default</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;joined_at&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  lastActiveAt   <span class="token keyword">DateTime</span>?         <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;last_active_at&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  completedAt    <span class="token keyword">DateTime</span>?         <span class="token variable">@map</span><span class="token punctuation">(</span><span class="token string">&quot;completed_at&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  gameInstance   GameInstance      <span class="token variable">@relation</span><span class="token punctuation">(</span><span class="token keyword">fields</span>: <span class="token punctuation">[</span>gameInstanceId<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">references</span>: <span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">,</span> onDelete: <span class="token keyword">Cascade</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">user</span>           <span class="token keyword">User</span>              <span class="token variable">@relation</span><span class="token punctuation">(</span><span class="token keyword">fields</span>: <span class="token punctuation">[</span>userId<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">references</span>: <span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">,</span> onDelete: <span class="token keyword">Cascade</span><span class="token punctuation">)</span></span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Statuts de participant :</strong></p><ul><li><code>PENDING</code> : En attente</li><li><code>ACTIVE</code> : Actif dans la partie</li><li><code>COMPLETED</code> : A terminé la partie</li><li><code>LEFT</code> : A quitté la partie</li></ul><h2 id="relations-entre-les-entites" tabindex="-1"><a class="header-anchor" href="#relations-entre-les-entites"><span>Relations entre les entités</span></a></h2><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">User</span>
<span class="line">├── 1:1 → StudentProfile/TeacherProfile</span>
<span class="line">├── 1:N → GameTemplate (created)</span>
<span class="line">├── 1:N → GameInstance (initiated)</span>
<span class="line">└── 1:N → GameParticipant</span>
<span class="line"></span>
<span class="line">GameTemplate</span>
<span class="line">├── 1:N → GameInstance</span>
<span class="line">├── 1:N → QuestionsInGameTemplate</span>
<span class="line">└── N:1 → User (creator)</span>
<span class="line"></span>
<span class="line">GameInstance</span>
<span class="line">├── N:1 → GameTemplate</span>
<span class="line">├── N:1 → User (initiator)</span>
<span class="line">└── 1:N → GameParticipant</span>
<span class="line"></span>
<span class="line">Question</span>
<span class="line">├── 1:1 → MultipleChoiceQuestion</span>
<span class="line">├── 1:1 → NumericQuestion</span>
<span class="line">└── 1:N → QuestionsInGameTemplate</span>
<span class="line"></span>
<span class="line">QuestionsInGameTemplate</span>
<span class="line">├── N:1 → GameTemplate</span>
<span class="line">└── N:1 → Question</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="index-et-contraintes" tabindex="-1"><a class="header-anchor" href="#index-et-contraintes"><span>Index et contraintes</span></a></h2><ul><li><strong>Index unique</strong> sur <code>GameInstance.accessCode</code> pour recherche rapide</li><li><strong>Index composite</strong> sur <code>QuestionsInGameTemplate(gameTemplateId, sequence)</code> pour l&#39;ordre des questions</li><li><strong>Contraintes de clé étrangère</strong> avec suppression en cascade pour maintenir l&#39;intégrité</li><li><strong>Index sur timestamps</strong> pour les requêtes de tri chronologique</li></ul><h2 id="migration-et-evolution" tabindex="-1"><a class="header-anchor" href="#migration-et-evolution"><span>Migration et évolution</span></a></h2><p>Le schéma évolue via les migrations Prisma :</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># Générer une nouvelle migration</span></span>
<span class="line">npx prisma migrate dev <span class="token parameter variable">--name</span> description_de_la_migration</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Appliquer les migrations</span></span>
<span class="line">npx prisma migrate deploy</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Générer le client Prisma</span></span>
<span class="line">npx prisma generate</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="cache-et-optimisation" tabindex="-1"><a class="header-anchor" href="#cache-et-optimisation"><span>Cache et optimisation</span></a></h2><p>Certaines données sont mises en cache dans Redis pour améliorer les performances :</p><ul><li>État des parties en cours</li><li>Timers des questions</li><li>Sessions utilisateur</li><li>Métadonnées des questions fréquemment utilisées</li></ul>`,44)]))}const o=n(p,[["render",i]]),u=JSON.parse('{"path":"/details-techniques/database.html","title":"Base de données","lang":"fr-FR","frontmatter":{},"git":{"updatedTime":1758286875000,"contributors":[{"name":"alexisflesch","username":"alexisflesch","email":"alexis.flesch@gmail.com","commits":14,"url":"https://github.com/alexisflesch"}],"changelog":[{"hash":"8fbb71211cc25ed6748dfb46362eb2796047c9da","time":1758286875000,"email":"alexis.flesch@gmail.com","author":"alexisflesch","message":"updating doc"},{"hash":"335192216d905607e2b483e26f8a24cdf1cb85de","time":1757423836000,"email":"alexis.flesch@gmail.com","author":"alexisflesch","message":"whitelist for usernames, more emojis, guest account was wrongly set as student account"},{"hash":"814841abdffc695272376a622588473528bbc5e8","time":1756990607000,"email":"alexis.flesch@gmail.com","author":"alexisflesch","message":"email check + new questions"},{"hash":"28022cbee66b34c738850167402caeee342f6c93","time":1754168341000,"email":"alexis.flesch@gmail.com","author":"alexisflesch","message":"critical bug fix for tournament flow"},{"hash":"6af085b5986ea77c5df7cd23dfa6a5d51d61acba","time":1754077088000,"email":"alexis.flesch@gmail.com","author":"alexisflesch","message":"adding \\"numeric\\" type of questions, still a lot to do but looks like solid base"},{"hash":"0878d5c1e534c213e5c776b7cc233184bcdeab62","time":1754051156000,"email":"alexis.flesch@gmail.com","author":"alexisflesch","message":"removed \\"isHidden\\" and added \\"excludedFrom\\" in Question schema"},{"hash":"e30ef291b874b8327f7efa62ecf64545ee927254","time":1753620852000,"email":"alexis.flesch@gmail.com","author":"alexisflesch","message":"differed tournaments bug fixes (still work to do with redis)."},{"hash":"2797cd8b531e17293071926983f826fd6ef56aa3","time":1752011272000,"email":"alexis.flesch@gmail.com","author":"alexisflesch","message":"merging properly lobby into live page and modernizing backend to deal with new flow"},{"hash":"f2cc89b08b87ca8b53c167ef59ac42d0e90d58d7","time":1751898443000,"email":"alexis.flesch@gmail.com","author":"alexisflesch","message":"timeLimit is now mandatory for all questions"},{"hash":"c9e43ffcceca33e6e8b4b6c96b1e6a082ecc8253","time":1750452348000,"email":"alexis.flesch@gmail.com","author":"alexisflesch","message":"foobar"},{"hash":"31ece8f91d935835a31cd1094e09b84fac42f3ca","time":1749042500000,"email":"alexis.flesch@gmail.com","author":"alexisflesch","message":"cleaning up"},{"hash":"2613ee24154a7b42325dd535bf1f51db66ef2bdb","time":1748793451000,"email":"alexis.flesch@gmail.com","author":"alexisflesch","message":"frontend update"},{"hash":"eb89f1b95bc08abeebfe208b092a46f8c6a38301","time":1747638046000,"email":"alexis.flesch@gmail.com","author":"alexisflesch","message":"backend full rewrite"},{"hash":"b9186a5a33f5c3d128e707566576d52dc3cee4c6","time":1747308278000,"email":"alexis.flesch@gmail.com","author":"alexisflesch","message":"complete backend rewrite with typescript and jest"}]},"filePathRelative":"details-techniques/database.md"}');export{o as comp,u as data};
