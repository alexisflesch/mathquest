<!doctype html>
<html lang="fr-FR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.23" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const useChoice = localStorage.getItem('vuepress-color-scheme')
      const systemStatus =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (useChoice === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (useChoice === 'dark' || systemStatus) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <link rel="icon" href="/mathquest/favicon.ico"><link rel="stylesheet" href="/mathquest/styles/screenshots.css"><title>Troubleshooting Guide | MathQuest</title><meta name="description" content="Common issues, debugging procedures, and solutions for MathQuest deployment and development">
    <link rel="preload" href="/mathquest/assets/style-Dkmw-xJK.css" as="style"><link rel="stylesheet" href="/mathquest/assets/style-Dkmw-xJK.css">
    <link rel="modulepreload" href="/mathquest/assets/app-DoDG4mLI.js"><link rel="modulepreload" href="/mathquest/assets/troubleshooting.html-CcGeBJgq.js">
    <link rel="prefetch" href="/mathquest/assets/index.html-DVgZZIvh.js" as="script"><link rel="prefetch" href="/mathquest/assets/index.html-D41YBSyI.js" as="script"><link rel="prefetch" href="/mathquest/assets/api.html-DuEObc8p.js" as="script"><link rel="prefetch" href="/mathquest/assets/architecture.html-u6XaedTl.js" as="script"><link rel="prefetch" href="/mathquest/assets/backend-services.html-Bn7Sl0dY.js" as="script"><link rel="prefetch" href="/mathquest/assets/configuration.html-CK6wnHSc.js" as="script"><link rel="prefetch" href="/mathquest/assets/database.html-Cst-518d.js" as="script"><link rel="prefetch" href="/mathquest/assets/deployement.html-DyDpUuyd.js" as="script"><link rel="prefetch" href="/mathquest/assets/performance-monitoring.html-rC33no4g.js" as="script"><link rel="prefetch" href="/mathquest/assets/scoring.html-Bcr7KETl.js" as="script"><link rel="prefetch" href="/mathquest/assets/security.html-CnxCz1Mf.js" as="script"><link rel="prefetch" href="/mathquest/assets/tests.html-hRJAedr5.js" as="script"><link rel="prefetch" href="/mathquest/assets/index.html-BOckdlIK.js" as="script"><link rel="prefetch" href="/mathquest/assets/index.html-C5kHWhGv.js" as="script"><link rel="prefetch" href="/mathquest/assets/contribuer.html-BwIMJqK-.js" as="script"><link rel="prefetch" href="/mathquest/assets/index.html-XR6uVX9n.js" as="script"><link rel="prefetch" href="/mathquest/assets/entrainement.html-ruDYf3W6.js" as="script"><link rel="prefetch" href="/mathquest/assets/quiz.html-Jk8e0nUz.js" as="script"><link rel="prefetch" href="/mathquest/assets/tournoi.html-DqqXOLYd.js" as="script"><link rel="prefetch" href="/mathquest/assets/404.html-DZLuBRi1.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/mathquest/"><img class="vp-site-logo" src="/mathquest/assets/logo.svg" alt="MathQuest"><span class="vp-site-name vp-hide-mobile" aria-hidden="true">MathQuest</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/mathquest/" aria-label="Accueil"><!--[--><!--[--><!--]--><!--]-->Accueil<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/mathquest/utilisation/" aria-label="Utilisation de l&#39;appli"><!--[--><!--[--><!--]--><!--]-->Utilisation de l&#39;appli<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/mathquest/questions-yaml/" aria-label="Écriture de questions"><!--[--><!--[--><!--]--><!--]-->Écriture de questions<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/mathquest/installation/" aria-label="Installation"><!--[--><!--[--><!--]--><!--]-->Installation<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/mathquest/details-techniques/" aria-label="Détails techniques"><!--[--><!--[--><!--]--><!--]-->Détails techniques<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/mathquest/" aria-label="Accueil"><!--[--><!--[--><!--]--><!--]-->Accueil<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/mathquest/utilisation/" aria-label="Utilisation de l&#39;appli"><!--[--><!--[--><!--]--><!--]-->Utilisation de l&#39;appli<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/mathquest/questions-yaml/" aria-label="Écriture de questions"><!--[--><!--[--><!--]--><!--]-->Écriture de questions<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/mathquest/installation/" aria-label="Installation"><!--[--><!--[--><!--]--><!--]-->Installation<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/mathquest/details-techniques/" aria-label="Détails techniques"><!--[--><!--[--><!--]--><!--]-->Détails techniques<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading active">Détails techniques (utilisateurs avancés seulement) <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link route-link-active auto-link vp-sidebar-item" href="/mathquest/details-techniques/" aria-label="Détails techniques (utilisateurs avancés seulement)"><!--[--><!--[--><!--]--><!--]-->Détails techniques (utilisateurs avancés seulement)<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/mathquest/details-techniques/architecture.html" aria-label="Architecture générale"><!--[--><!--[--><!--]--><!--]-->Architecture générale<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/mathquest/details-techniques/database.html" aria-label="Base de données"><!--[--><!--[--><!--]--><!--]-->Base de données<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/mathquest/details-techniques/scoring.html" aria-label="Système de scoring"><!--[--><!--[--><!--]--><!--]-->Système de scoring<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/mathquest/details-techniques/backend-services.html" aria-label="Services backend"><!--[--><!--[--><!--]--><!--]-->Services backend<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/mathquest/details-techniques/api.html" aria-label="API REST"><!--[--><!--[--><!--]--><!--]-->API REST<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/mathquest/details-techniques/configuration.html" aria-label="Configuration et environnement"><!--[--><!--[--><!--]--><!--]-->Configuration et environnement<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/mathquest/details-techniques/tests.html" aria-label="Tests et qualité"><!--[--><!--[--><!--]--><!--]-->Tests et qualité<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/mathquest/details-techniques/deployement.html" aria-label="Déploiement et DevOps"><!--[--><!--[--><!--]--><!--]-->Déploiement et DevOps<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/mathquest/details-techniques/security.html" aria-label="Security Documentation"><!--[--><!--[--><!--]--><!--]-->Security Documentation<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/mathquest/details-techniques/performance-monitoring.html" aria-label="Performance &amp; Monitoring"><!--[--><!--[--><!--]--><!--]-->Performance &amp; Monitoring<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link route-link-active auto-link vp-sidebar-item active" href="/mathquest/details-techniques/troubleshooting.html" aria-label="Troubleshooting Guide"><!--[--><!--[--><!--]--><!--]-->Troubleshooting Guide<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div vp-content><!--[--><!--]--><div id="content"><h1 id="troubleshooting-guide" tabindex="-1"><a class="header-anchor" href="#troubleshooting-guide"><span>Troubleshooting Guide</span></a></h1><p>This guide covers common issues, debugging procedures, and solutions for MathQuest deployment and development.</p><h2 id="quick-diagnosis" tabindex="-1"><a class="header-anchor" href="#quick-diagnosis"><span>Quick Diagnosis</span></a></h2><h3 id="health-check-commands" tabindex="-1"><a class="header-anchor" href="#health-check-commands"><span>Health Check Commands</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># Check all services status</span></span>
<span class="line">pm2 status</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Check memory usage</span></span>
<span class="line"><span class="token function">curl</span> http://localhost:3007/health/memory</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Check basic health</span></span>
<span class="line"><span class="token function">curl</span> http://localhost:3007/health</span>
<span class="line"></span>
<span class="line"><span class="token comment"># View recent logs</span></span>
<span class="line">pm2 logs <span class="token parameter variable">--lines</span> <span class="token number">50</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Check Redis connection</span></span>
<span class="line">redis-cli <span class="token function">ping</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="common-symptoms-and-solutions" tabindex="-1"><a class="header-anchor" href="#common-symptoms-and-solutions"><span>Common Symptoms and Solutions</span></a></h3><h2 id="memory-issues" tabindex="-1"><a class="header-anchor" href="#memory-issues"><span>Memory Issues</span></a></h2><h3 id="symptom-application-crashes-with-javascript-heap-out-of-memory" tabindex="-1"><a class="header-anchor" href="#symptom-application-crashes-with-javascript-heap-out-of-memory"><span>Symptom: Application crashes with &quot;JavaScript heap out of memory&quot;</span></a></h3><p><strong>Solutions:</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 1. Check current memory usage</span></span>
<span class="line"><span class="token function">curl</span> http://localhost:3007/health/memory</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 2. Restart with ultra-limited memory settings</span></span>
<span class="line"><span class="token builtin class-name">cd</span> backend <span class="token operator">&amp;&amp;</span> <span class="token function">npm</span> run start:ultra-limited</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 3. Check PM2 memory limits</span></span>
<span class="line">pm2 show mathquest-backend</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 4. Rebuild with low-memory optimization</span></span>
<span class="line"><span class="token function">bash</span> build-vps.sh</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Prevention:</strong></p><ul><li>Use <code>build-vps.sh</code> for VPS deployment</li><li>Monitor memory with <code>/health/memory</code> endpoint</li><li>Set appropriate PM2 memory limits in <code>ecosystem.config.js</code></li></ul><h3 id="symptom-pm2-auto-restarts-due-to-memory-limits" tabindex="-1"><a class="header-anchor" href="#symptom-pm2-auto-restarts-due-to-memory-limits"><span>Symptom: PM2 auto-restarts due to memory limits</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># Check restart history</span></span>
<span class="line">pm2 show mathquest-backend</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Adjust memory limits in ecosystem.config.js</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&quot;max_memory_restart&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;500M&quot;</span>,  // Increase <span class="token keyword">if</span> needed</span>
<span class="line">    <span class="token string">&quot;max_memory_restart&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;300M&quot;</span>   // For frontend</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="database-connection-issues" tabindex="-1"><a class="header-anchor" href="#database-connection-issues"><span>Database Connection Issues</span></a></h2><h3 id="symptom-can-t-reach-database-server-or-connection-timeouts" tabindex="-1"><a class="header-anchor" href="#symptom-can-t-reach-database-server-or-connection-timeouts"><span>Symptom: &quot;Can&#39;t reach database server&quot; or connection timeouts</span></a></h3><p><strong>Diagnosis:</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># Check database connectivity</span></span>
<span class="line">psql <span class="token parameter variable">-h</span> localhost <span class="token parameter variable">-U</span> postgre <span class="token parameter variable">-d</span> mathquest <span class="token parameter variable">-c</span> <span class="token string">&quot;SELECT 1;&quot;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Check Prisma connection</span></span>
<span class="line"><span class="token builtin class-name">cd</span> backend <span class="token operator">&amp;&amp;</span> npx prisma db push --preview-feature</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Verify environment variables</span></span>
<span class="line"><span class="token function">cat</span> backend/.env <span class="token operator">|</span> <span class="token function">grep</span> DATABASE_URL</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Solutions:</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 1. Restart PostgreSQL service</span></span>
<span class="line"><span class="token function">sudo</span> systemctl restart postgresql</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 2. Check database logs</span></span>
<span class="line"><span class="token function">sudo</span> <span class="token function">tail</span> <span class="token parameter variable">-f</span> /var/log/postgresql/postgresql-*.log</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 3. Verify connection string</span></span>
<span class="line"><span class="token assign-left variable">DATABASE_URL</span><span class="token operator">=</span><span class="token string">&quot;postgresql://postgre:dev123@localhost:5432/mathquest&quot;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 4. Reset database connection pool</span></span>
<span class="line">pm2 restart mathquest-backend</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="symptom-prisma-migration-errors" tabindex="-1"><a class="header-anchor" href="#symptom-prisma-migration-errors"><span>Symptom: Prisma migration errors</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># Check migration status</span></span>
<span class="line"><span class="token builtin class-name">cd</span> backend <span class="token operator">&amp;&amp;</span> npx prisma migrate status</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Apply pending migrations</span></span>
<span class="line">npx prisma migrate deploy</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Reset database (development only)</span></span>
<span class="line">npx prisma migrate reset <span class="token parameter variable">--force</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="redis-connection-issues" tabindex="-1"><a class="header-anchor" href="#redis-connection-issues"><span>Redis Connection Issues</span></a></h2><h3 id="symptom-redis-connection-failed-or-caching-not-working" tabindex="-1"><a class="header-anchor" href="#symptom-redis-connection-failed-or-caching-not-working"><span>Symptom: &quot;Redis connection failed&quot; or caching not working</span></a></h3><p><strong>Diagnosis:</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># Check Redis service</span></span>
<span class="line">redis-cli <span class="token function">ping</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Check Redis memory usage</span></span>
<span class="line">redis-cli info memory</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Verify Redis URL in environment</span></span>
<span class="line"><span class="token function">cat</span> backend/.env <span class="token operator">|</span> <span class="token function">grep</span> REDIS_URL</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Solutions:</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 1. Start Redis service</span></span>
<span class="line"><span class="token function">sudo</span> systemctl start redis-server</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 2. Check Redis configuration</span></span>
<span class="line">redis-cli config get maxmemory</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 3. Clear Redis cache (if needed)</span></span>
<span class="line">redis-cli FLUSHALL</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 4. Restart application</span></span>
<span class="line">pm2 restart mathquest-backend</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="socket-io-connection-issues" tabindex="-1"><a class="header-anchor" href="#socket-io-connection-issues"><span>Socket.IO Connection Issues</span></a></h2><h3 id="symptom-real-time-features-not-working-timers-live-updates" tabindex="-1"><a class="header-anchor" href="#symptom-real-time-features-not-working-timers-live-updates"><span>Symptom: Real-time features not working (timers, live updates)</span></a></h3><p><strong>Diagnosis:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// Check Socket.IO connection in browser console</span></span>
<span class="line"><span class="token keyword">const</span> socket <span class="token operator">=</span> <span class="token function">io</span><span class="token punctuation">(</span><span class="token string">&#39;http://localhost:3007&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;connect&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Connected&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;connect_error&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Connection error:&#39;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Solutions:</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 1. Check Socket.IO server logs</span></span>
<span class="line">pm2 logs mathquest-backend <span class="token operator">|</span> <span class="token function">grep</span> socket</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 2. Verify CORS configuration</span></span>
<span class="line"><span class="token function">curl</span> <span class="token parameter variable">-H</span> <span class="token string">&quot;Origin: http://localhost:3008&quot;</span> http://localhost:3007/api/socket.io/</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 3. Check Redis adapter (if using multiple servers)</span></span>
<span class="line">redis-cli keys <span class="token string">&quot;socket.io*&quot;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 4. Restart Socket.IO server</span></span>
<span class="line">pm2 restart mathquest-backend</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="symptom-websocket-connections-failing-in-production" tabindex="-1"><a class="header-anchor" href="#symptom-websocket-connections-failing-in-production"><span>Symptom: WebSocket connections failing in production</span></a></h3><div class="language-nginx line-numbers-mode" data-highlighter="prismjs" data-ext="nginx"><pre><code class="language-nginx"><span class="line"><span class="token comment"># Nginx configuration for WebSocket proxy</span></span>
<span class="line"><span class="token directive"><span class="token keyword">location</span> /api/socket.io/</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token directive"><span class="token keyword">proxy_pass</span> http://127.0.0.1:3007/api/socket.io/</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token directive"><span class="token keyword">proxy_http_version</span> 1.1</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token directive"><span class="token keyword">proxy_set_header</span> Upgrade <span class="token variable">$http_upgrade</span></span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token directive"><span class="token keyword">proxy_set_header</span> Connection <span class="token string">&quot;upgrade&quot;</span></span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token directive"><span class="token keyword">proxy_set_header</span> Host <span class="token variable">$host</span></span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="authentication-issues" tabindex="-1"><a class="header-anchor" href="#authentication-issues"><span>Authentication Issues</span></a></h2><h3 id="symptom-users-can-t-log-in-or-jwt-tokens-are-invalid" tabindex="-1"><a class="header-anchor" href="#symptom-users-can-t-log-in-or-jwt-tokens-are-invalid"><span>Symptom: Users can&#39;t log in or JWT tokens are invalid</span></a></h3><p><strong>Diagnosis:</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># Check JWT secret configuration</span></span>
<span class="line"><span class="token function">cat</span> backend/.env <span class="token operator">|</span> <span class="token function">grep</span> JWT_SECRET</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Verify token format in browser dev tools</span></span>
<span class="line"><span class="token comment"># Application &gt; Local Storage &gt; auth_token</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Solutions:</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 1. Generate new JWT secret</span></span>
<span class="line"><span class="token function">node</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;console.log(require(&#39;crypto&#39;).randomBytes(64).toString(&#39;hex&#39;))&quot;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 2. Update environment file</span></span>
<span class="line"><span class="token builtin class-name">echo</span> <span class="token string">&quot;JWT_SECRET=your-new-secret-here&quot;</span> <span class="token operator">&gt;&gt;</span> backend/.env</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 3. Clear browser cookies and local storage</span></span>
<span class="line"><span class="token comment"># Browser Dev Tools &gt; Application &gt; Clear storage</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 4. Restart backend</span></span>
<span class="line">pm2 restart mathquest-backend</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="symptom-password-reset-emails-not-sending" tabindex="-1"><a class="header-anchor" href="#symptom-password-reset-emails-not-sending"><span>Symptom: Password reset emails not sending</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># Check Brevo API configuration</span></span>
<span class="line"><span class="token function">cat</span> backend/.env <span class="token operator">|</span> <span class="token function">grep</span> BREVO</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Test email service</span></span>
<span class="line"><span class="token function">curl</span> <span class="token parameter variable">-X</span> POST https://api.brevo.com/v3/smtp/email <span class="token punctuation">\</span></span>
<span class="line">  <span class="token parameter variable">-H</span> <span class="token string">&quot;api-key: YOUR_API_KEY&quot;</span> <span class="token punctuation">\</span></span>
<span class="line">  <span class="token parameter variable">-H</span> <span class="token string">&quot;Content-Type: application/json&quot;</span> <span class="token punctuation">\</span></span>
<span class="line">  <span class="token parameter variable">-d</span> <span class="token string">&#39;{&quot;to&quot;:[{&quot;email&quot;:&quot;test@example.com&quot;}],&quot;templateId&quot;:1}&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="build-and-deployment-issues" tabindex="-1"><a class="header-anchor" href="#build-and-deployment-issues"><span>Build and Deployment Issues</span></a></h2><h3 id="symptom-build-fails-with-memory-errors" tabindex="-1"><a class="header-anchor" href="#symptom-build-fails-with-memory-errors"><span>Symptom: Build fails with memory errors</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># Use low-memory build mode</span></span>
<span class="line"><span class="token function">bash</span> build-all.sh --low-memory</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Or set memory limits manually</span></span>
<span class="line"><span class="token assign-left variable">NODE_OPTIONS</span><span class="token operator">=</span><span class="token string">&quot;--max-old-space-size=1024&quot;</span> <span class="token function">npm</span> run build</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="symptom-frontend-build-hangs-or-fails" tabindex="-1"><a class="header-anchor" href="#symptom-frontend-build-hangs-or-fails"><span>Symptom: Frontend build hangs or fails</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># Clear Next.js cache</span></span>
<span class="line"><span class="token function">rm</span> <span class="token parameter variable">-rf</span> frontend/.next</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Check Node.js version compatibility</span></span>
<span class="line"><span class="token function">node</span> <span class="token parameter variable">--version</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Rebuild with verbose logging</span></span>
<span class="line"><span class="token builtin class-name">cd</span> frontend <span class="token operator">&amp;&amp;</span> <span class="token function">npm</span> run build <span class="token parameter variable">--verbose</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="symptom-pm2-fails-to-start-services" tabindex="-1"><a class="header-anchor" href="#symptom-pm2-fails-to-start-services"><span>Symptom: PM2 fails to start services</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># Check PM2 logs</span></span>
<span class="line">pm2 logs</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Delete and recreate PM2 processes</span></span>
<span class="line">pm2 delete all</span>
<span class="line">pm2 start ecosystem.config.js</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Check file permissions</span></span>
<span class="line"><span class="token function">ls</span> <span class="token parameter variable">-la</span> start-all.sh</span>
<span class="line"><span class="token function">chmod</span> +x start-all.sh</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="pwa-and-service-worker-issues" tabindex="-1"><a class="header-anchor" href="#pwa-and-service-worker-issues"><span>PWA and Service Worker Issues</span></a></h2><h3 id="symptom-service-worker-javascript-errors-ref-is-not-defined" tabindex="-1"><a class="header-anchor" href="#symptom-service-worker-javascript-errors-ref-is-not-defined"><span>Symptom: Service worker JavaScript errors (<code>_ref is not defined</code>)</span></a></h3><p><strong>Cause:</strong> Bug in <code>@ducanh2912/next-pwa</code> library causing serialization issues with async cache plugins.</p><p><strong>Symptoms:</strong></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// Browser console error</span></span>
<span class="line">sw<span class="token operator">-</span>v3<span class="token punctuation">.</span>js<span class="token operator">:</span><span class="token number">1</span> <span class="token function">Uncaught</span> <span class="token punctuation">(</span><span class="token keyword">in</span> promise<span class="token punctuation">)</span> ReferenceError<span class="token operator">:</span> _ref is not defined</span>
<span class="line">    at Object<span class="token punctuation">.</span><span class="token function">cacheWillUpdate</span> <span class="token punctuation">(</span>sw<span class="token operator">-</span>v3<span class="token punctuation">.</span>js<span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">12607</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Solutions:</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 1. Update service worker configuration in next.config.ts</span></span>
<span class="line"><span class="token comment"># Change NetworkFirst to StaleWhileRevalidate without plugins</span></span>
<span class="line">runtimeCaching: <span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        urlPattern: <span class="token string">&#39;/&#39;</span>,</span>
<span class="line">        handler: <span class="token string">&#39;StaleWhileRevalidate&#39;</span>,</span>
<span class="line">        options: <span class="token punctuation">{</span></span>
<span class="line">            cacheName: <span class="token string">&#39;start-url&#39;</span></span>
<span class="line">        <span class="token punctuation">}</span>,</span>
<span class="line">    <span class="token punctuation">}</span>,</span>
<span class="line"><span class="token punctuation">]</span>,</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 2. Rebuild the frontend (postbuild script will automatically fix SW)</span></span>
<span class="line"><span class="token builtin class-name">cd</span> frontend <span class="token operator">&amp;&amp;</span> <span class="token function">npm</span> run build</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 3. Hard refresh browser or update service worker</span></span>
<span class="line"><span class="token comment"># In DevTools: Application → Service Workers → Update/Unregister</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Note:</strong> A postbuild script automatically removes any broken registerRoute from the generated service worker. This ensures the fix is applied consistently after each build. The bug can be reproduced using <code>node scripts/test-ref-bug.js</code> on an unfixed service worker.</p><h2 id="performance-issues" tabindex="-1"><a class="header-anchor" href="#performance-issues"><span>Performance Issues</span></a></h2><h3 id="symptom-application-is-slow-or-unresponsive" tabindex="-1"><a class="header-anchor" href="#symptom-application-is-slow-or-unresponsive"><span>Symptom: Application is slow or unresponsive</span></a></h3><p><strong>Diagnosis:</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># Check memory usage</span></span>
<span class="line"><span class="token function">curl</span> http://localhost:3007/health/memory</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Monitor PM2 processes</span></span>
<span class="line">pm2 monit</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Check database query performance</span></span>
<span class="line"><span class="token comment"># Enable query logging in development</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Solutions:</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 1. Restart services</span></span>
<span class="line">pm2 restart all</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 2. Clear caches</span></span>
<span class="line">redis-cli FLUSHALL</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 3. Check database connections</span></span>
<span class="line">psql <span class="token parameter variable">-h</span> localhost <span class="token parameter variable">-U</span> postgre <span class="token parameter variable">-d</span> mathquest <span class="token parameter variable">-c</span> <span class="token string">&quot;SELECT count(*) FROM pg_stat_activity;&quot;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 4. Optimize memory usage</span></span>
<span class="line"><span class="token function">bash</span> build-vps.sh <span class="token operator">&amp;&amp;</span> <span class="token function">bash</span> start-all.sh</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="symptom-high-cpu-usage" tabindex="-1"><a class="header-anchor" href="#symptom-high-cpu-usage"><span>Symptom: High CPU usage</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># Check process CPU usage</span></span>
<span class="line">pm2 monit</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Profile Node.js application</span></span>
<span class="line"><span class="token builtin class-name">cd</span> backend <span class="token operator">&amp;&amp;</span> <span class="token function">npm</span> run monitor:memory</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Check for infinite loops in logs</span></span>
<span class="line">pm2 logs <span class="token parameter variable">--lines</span> <span class="token number">100</span> <span class="token operator">|</span> <span class="token function">grep</span> error</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="network-and-cors-issues" tabindex="-1"><a class="header-anchor" href="#network-and-cors-issues"><span>Network and CORS Issues</span></a></h2><h3 id="symptom-cors-errors-in-browser-console" tabindex="-1"><a class="header-anchor" href="#symptom-cors-errors-in-browser-console"><span>Symptom: CORS errors in browser console</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// Error: Access to XMLHttpRequest has been blocked by CORS policy</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>Solutions:</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># 1. Check CORS configuration in server.ts</span></span>
<span class="line"><span class="token function">grep</span> <span class="token parameter variable">-n</span> <span class="token string">&quot;cors&quot;</span> backend/src/server.ts</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 2. Verify frontend URL in environment</span></span>
<span class="line"><span class="token function">cat</span> backend/.env <span class="token operator">|</span> <span class="token function">grep</span> FRONTEND_URL</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 3. Update CORS origins for production</span></span>
<span class="line">const corsOptions <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">    origin: process.env.NODE_ENV <span class="token operator">==</span><span class="token operator">=</span> <span class="token string">&#39;production&#39;</span></span>
<span class="line">        ? process.env.FRONTEND_URL</span>
<span class="line">        <span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">&#39;http://localhost:3000&#39;</span>, <span class="token string">&#39;http://localhost:3008&#39;</span><span class="token punctuation">]</span>,</span>
<span class="line">    credentials: <span class="token boolean">true</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="symptom-nginx-proxy-errors" tabindex="-1"><a class="header-anchor" href="#symptom-nginx-proxy-errors"><span>Symptom: Nginx proxy errors</span></a></h3><div class="language-nginx line-numbers-mode" data-highlighter="prismjs" data-ext="nginx"><pre><code class="language-nginx"><span class="line"><span class="token comment"># Check Nginx configuration</span></span>
<span class="line">sudo nginx -t</span>
<span class="line"></span>
<span class="line"><span class="token comment"># View Nginx error logs</span></span>
<span class="line">sudo tail -f /var/log/nginx/error.log</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Test proxy configuration</span></span>
<span class="line">curl -H &quot;Host: yourdomain.com&quot; http://127.0.0.1/api/v1/health</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="development-environment-issues" tabindex="-1"><a class="header-anchor" href="#development-environment-issues"><span>Development Environment Issues</span></a></h2><h3 id="symptom-hot-reload-not-working" tabindex="-1"><a class="header-anchor" href="#symptom-hot-reload-not-working"><span>Symptom: Hot reload not working</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># Check file watching limits</span></span>
<span class="line"><span class="token function">cat</span> /proc/sys/fs/inotify/max_user_watches</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Increase watch limits if needed</span></span>
<span class="line"><span class="token builtin class-name">echo</span> <span class="token assign-left variable">fs.inotify.max_user_watches</span><span class="token operator">=</span><span class="token number">524288</span> <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> <span class="token parameter variable">-a</span> /etc/sysctl.conf</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">sysctl</span> <span class="token parameter variable">-p</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="symptom-typescript-compilation-errors" tabindex="-1"><a class="header-anchor" href="#symptom-typescript-compilation-errors"><span>Symptom: TypeScript compilation errors</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># Clear TypeScript cache</span></span>
<span class="line"><span class="token function">rm</span> <span class="token parameter variable">-rf</span> backend/dist frontend/.next</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Check TypeScript configuration</span></span>
<span class="line"><span class="token builtin class-name">cd</span> backend <span class="token operator">&amp;&amp;</span> npx tsc <span class="token parameter variable">--noEmit</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Reinstall dependencies</span></span>
<span class="line"><span class="token function">rm</span> <span class="token parameter variable">-rf</span> node_modules package-lock.json</span>
<span class="line"><span class="token function">npm</span> <span class="token function">install</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="database-migration-issues" tabindex="-1"><a class="header-anchor" href="#database-migration-issues"><span>Database Migration Issues</span></a></h2><h3 id="symptom-prisma-schema-changes-not-applied" tabindex="-1"><a class="header-anchor" href="#symptom-prisma-schema-changes-not-applied"><span>Symptom: Prisma schema changes not applied</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># Check migration status</span></span>
<span class="line"><span class="token builtin class-name">cd</span> backend <span class="token operator">&amp;&amp;</span> npx prisma migrate status</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Generate Prisma client</span></span>
<span class="line">npx prisma generate</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Apply migrations</span></span>
<span class="line">npx prisma migrate deploy</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Reset database (development only)</span></span>
<span class="line">npx prisma migrate reset</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="symptom-database-schema-drift" tabindex="-1"><a class="header-anchor" href="#symptom-database-schema-drift"><span>Symptom: Database schema drift</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># Check for schema differences</span></span>
<span class="line"><span class="token builtin class-name">cd</span> backend <span class="token operator">&amp;&amp;</span> npx prisma db push --preview-feature</span>
<span class="line"></span>
<span class="line"><span class="token comment"># View current schema</span></span>
<span class="line">npx prisma db pull</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Reset and reapply schema</span></span>
<span class="line">npx prisma migrate reset <span class="token parameter variable">--force</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="logging-and-debugging" tabindex="-1"><a class="header-anchor" href="#logging-and-debugging"><span>Logging and Debugging</span></a></h2><h3 id="enable-debug-logging" tabindex="-1"><a class="header-anchor" href="#enable-debug-logging"><span>Enable Debug Logging</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># Set log level to debug</span></span>
<span class="line"><span class="token builtin class-name">echo</span> <span class="token string">&quot;LOG_LEVEL=debug&quot;</span> <span class="token operator">&gt;&gt;</span> backend/.env</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Restart services</span></span>
<span class="line">pm2 restart mathquest-backend</span>
<span class="line"></span>
<span class="line"><span class="token comment"># View debug logs</span></span>
<span class="line">pm2 logs mathquest-backend <span class="token parameter variable">--lines</span> <span class="token number">100</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="browser-debugging" tabindex="-1"><a class="header-anchor" href="#browser-debugging"><span>Browser Debugging</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// Enable Socket.IO debug logging</span></span>
<span class="line">localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">&#39;debug&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;socket.io-client:*&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Monitor network requests</span></span>
<span class="line"><span class="token comment">// Browser Dev Tools &gt; Network &gt; Filter by WS (WebSocket)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Check console for errors</span></span>
<span class="line"><span class="token comment">// Browser Dev Tools &gt; Console</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="database-debugging" tabindex="-1"><a class="header-anchor" href="#database-debugging"><span>Database Debugging</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql"><pre><code class="language-sql"><span class="line"><span class="token comment">-- Check active connections</span></span>
<span class="line"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> pg_stat_activity<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- View slow queries</span></span>
<span class="line"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> pg_stat_statements</span>
<span class="line"><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> total_time <span class="token keyword">DESC</span></span>
<span class="line"><span class="token keyword">LIMIT</span> <span class="token number">10</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">-- Check table sizes</span></span>
<span class="line"><span class="token keyword">SELECT</span> schemaname<span class="token punctuation">,</span> tablename<span class="token punctuation">,</span></span>
<span class="line">       pg_size_pretty<span class="token punctuation">(</span>pg_total_relation_size<span class="token punctuation">(</span>schemaname<span class="token operator">||</span><span class="token string">&#39;.&#39;</span><span class="token operator">||</span>tablename<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">FROM</span> pg_tables</span>
<span class="line"><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> pg_total_relation_size<span class="token punctuation">(</span>schemaname<span class="token operator">||</span><span class="token string">&#39;.&#39;</span><span class="token operator">||</span>tablename<span class="token punctuation">)</span> <span class="token keyword">DESC</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="emergency-recovery" tabindex="-1"><a class="header-anchor" href="#emergency-recovery"><span>Emergency Recovery</span></a></h2><h3 id="complete-system-reset" tabindex="-1"><a class="header-anchor" href="#complete-system-reset"><span>Complete System Reset</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># Stop all services</span></span>
<span class="line">pm2 stop all</span>
<span class="line">pm2 delete all</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Clear caches</span></span>
<span class="line">redis-cli FLUSHALL</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Reset database (CAUTION: destroys data)</span></span>
<span class="line"><span class="token builtin class-name">cd</span> backend <span class="token operator">&amp;&amp;</span> npx prisma migrate reset <span class="token parameter variable">--force</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Rebuild application</span></span>
<span class="line"><span class="token function">bash</span> build-vps.sh</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Restart services</span></span>
<span class="line"><span class="token function">bash</span> start-all.sh</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="data-recovery" tabindex="-1"><a class="header-anchor" href="#data-recovery"><span>Data Recovery</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># Create database backup</span></span>
<span class="line">pg_dump <span class="token parameter variable">-U</span> postgre <span class="token parameter variable">-h</span> localhost mathquest <span class="token operator">&gt;</span> backup.sql</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Restore from backup</span></span>
<span class="line">psql <span class="token parameter variable">-U</span> postgre <span class="token parameter variable">-h</span> localhost mathquest <span class="token operator">&amp;</span>lt<span class="token punctuation">;</span> backup.sql</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="getting-help" tabindex="-1"><a class="header-anchor" href="#getting-help"><span>Getting Help</span></a></h2><h3 id="diagnostic-information-to-collect" tabindex="-1"><a class="header-anchor" href="#diagnostic-information-to-collect"><span>Diagnostic Information to Collect</span></a></h3><p>When reporting issues, please include:</p><ol><li><p><strong>System Information:</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">uname</span> <span class="token parameter variable">-a</span></span>
<span class="line"><span class="token function">node</span> <span class="token parameter variable">--version</span></span>
<span class="line"><span class="token function">npm</span> <span class="token parameter variable">--version</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>Service Status:</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">pm2 status</span>
<span class="line">pm2 logs <span class="token parameter variable">--lines</span> <span class="token number">20</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>Memory and Performance:</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">curl</span> http://localhost:3007/health/memory</span>
<span class="line"><span class="token function">free</span> <span class="token parameter variable">-h</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>Configuration:</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">cat</span> backend/.env <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> PASSWORD</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p><strong>Error Logs:</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">pm2 logs mathquest-backend <span class="token parameter variable">--err</span> <span class="token parameter variable">--lines</span> <span class="token number">50</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ol><h3 id="support-resources" tabindex="-1"><a class="header-anchor" href="#support-resources"><span>Support Resources</span></a></h3><ul><li><strong>GitHub Issues</strong>: Report bugs and request features</li><li><strong>Documentation</strong>: Check VuePress docs for detailed guides</li><li><strong>Community</strong>: Join discussions for common solutions</li><li><strong>Logs</strong>: Always include relevant log output with issues</li></ul><h2 id="prevention-best-practices" tabindex="-1"><a class="header-anchor" href="#prevention-best-practices"><span>Prevention Best Practices</span></a></h2><h3 id="regular-maintenance" tabindex="-1"><a class="header-anchor" href="#regular-maintenance"><span>Regular Maintenance</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># Weekly maintenance script</span></span>
<span class="line"><span class="token comment">#!/bin/bash</span></span>
<span class="line"><span class="token comment"># Clear old logs</span></span>
<span class="line">pm2 flush</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Check disk space</span></span>
<span class="line"><span class="token function">df</span> <span class="token parameter variable">-h</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Verify service health</span></span>
<span class="line"><span class="token function">curl</span> http://localhost:3007/health</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Update dependencies</span></span>
<span class="line"><span class="token function">npm</span> audit fix</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="monitoring-setup" tabindex="-1"><a class="header-anchor" href="#monitoring-setup"><span>Monitoring Setup</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># Install monitoring tools</span></span>
<span class="line"><span class="token function">npm</span> <span class="token function">install</span> <span class="token parameter variable">-g</span> pm2-logrotate</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Configure log rotation</span></span>
<span class="line">pm2 <span class="token function">install</span> pm2-logrotate</span>
<span class="line">pm2 <span class="token builtin class-name">set</span> pm2-logrotate:max_size 10M</span>
<span class="line">pm2 <span class="token builtin class-name">set</span> pm2-logrotate:retain <span class="token number">7</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="backup-strategy" tabindex="-1"><a class="header-anchor" href="#backup-strategy"><span>Backup Strategy</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token comment"># Daily backup script</span></span>
<span class="line"><span class="token comment">#!/bin/bash</span></span>
<span class="line"><span class="token assign-left variable">DATE</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%Y%m%d<span class="token variable">)</span></span></span>
<span class="line">pg_dump <span class="token parameter variable">-U</span> postgre mathquest <span class="token operator">&gt;</span> <span class="token string">&quot;backup_<span class="token variable">$DATE</span>.sql&quot;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Keep last 7 days</span></span>
<span class="line"><span class="token function">ls</span> backup_*.sql <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-n</span> <span class="token parameter variable">-7</span> <span class="token operator">|</span> <span class="token function">xargs</span> <span class="token function">rm</span> <span class="token parameter variable">-f</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>This troubleshooting guide should be updated as new issues are discovered and resolved.</p></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">Dernière mise à jour: </span><time class="meta-item-info" datetime="2025-09-22T05:36:40.000Z" data-allow-mismatch>22/09/2025 07:36</time></div><div class="vp-meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: alexis.flesch@gmail.com">alexisflesch</span><!----><!--]--><!--]--></span></div></div></footer><nav class="vp-page-nav" aria-label="page navigation"><a class="route-link auto-link prev" href="/mathquest/details-techniques/performance-monitoring.html" aria-label="Performance &amp; Monitoring"><!--[--><div class="hint"><span class="arrow left"></span> Prev</div><div class="link"><span class="external-link">Performance &amp; Monitoring</span></div><!--]--></a><!----></nav><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/mathquest/assets/app-DoDG4mLI.js" defer></script>
  </body>
</html>
