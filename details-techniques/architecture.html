<!doctype html>
<html lang="fr-FR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.23" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const useChoice = localStorage.getItem('vuepress-color-scheme')
      const systemStatus =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (useChoice === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (useChoice === 'dark' || systemStatus) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/styles/screenshots.css"><title>Architecture générale | Kutsum</title><meta name="description" content="Alternative libre et open source à Kahoot, pour les enseignants et leurs élèves.">
    <link rel="preload" href="/assets/style-Dkmw-xJK.css" as="style"><link rel="stylesheet" href="/assets/style-Dkmw-xJK.css">
    <link rel="modulepreload" href="/assets/app-Blvv7Pu1.js"><link rel="modulepreload" href="/assets/architecture.html-C2TIKhjm.js">
    <link rel="prefetch" href="/assets/index.html-BgWsLJk5.js" as="script"><link rel="prefetch" href="/assets/index.html-CxFhQ9yh.js" as="script"><link rel="prefetch" href="/assets/api.html-B_bdbqlW.js" as="script"><link rel="prefetch" href="/assets/backend-services.html-B5XZ0b45.js" as="script"><link rel="prefetch" href="/assets/configuration.html-CSBv4zlE.js" as="script"><link rel="prefetch" href="/assets/database.html-zDPra4qo.js" as="script"><link rel="prefetch" href="/assets/deployement.html-Cb8coLaH.js" as="script"><link rel="prefetch" href="/assets/landing-page.html-DFa_9Yed.js" as="script"><link rel="prefetch" href="/assets/performance-monitoring.html-DkqiKT9u.js" as="script"><link rel="prefetch" href="/assets/question-editor.html-KCmeVQ8t.js" as="script"><link rel="prefetch" href="/assets/scoring.html-BgDchvD2.js" as="script"><link rel="prefetch" href="/assets/security.html-CR7bBL-N.js" as="script"><link rel="prefetch" href="/assets/tests.html-DOtCFwSL.js" as="script"><link rel="prefetch" href="/assets/troubleshooting.html-G-04tDSs.js" as="script"><link rel="prefetch" href="/assets/diagnostics.html-DKbQEDup.js" as="script"><link rel="prefetch" href="/assets/observability.html-DkPbL3ic.js" as="script"><link rel="prefetch" href="/assets/index.html-Tv1AKkVx.js" as="script"><link rel="prefetch" href="/assets/index.html-D4Ge4R3B.js" as="script"><link rel="prefetch" href="/assets/aflesch-espaces-vectoriels-notes.html-CarfwQKl.js" as="script"><link rel="prefetch" href="/assets/contribuer.html-BFpj89FN.js" as="script"><link rel="prefetch" href="/assets/index.html-JVJ8j1aq.js" as="script"><link rel="prefetch" href="/assets/entrainement.html-DAbAqH-4.js" as="script"><link rel="prefetch" href="/assets/quiz.html-H3MzSQm9.js" as="script"><link rel="prefetch" href="/assets/tournoi.html-DylmTv1c.js" as="script"><link rel="prefetch" href="/assets/404.html-T_x5-zmb.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><img class="vp-site-logo" src="/assets/logo.svg" alt="Kutsum"><span class="vp-site-name vp-hide-mobile" aria-hidden="true">Kutsum</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="Accueil"><!--[--><!--[--><!--]--><!--]-->Accueil<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/utilisation/" aria-label="Utilisation de l&#39;appli"><!--[--><!--[--><!--]--><!--]-->Utilisation de l&#39;appli<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/questions-yaml/" aria-label="Création de questions"><!--[--><!--[--><!--]--><!--]-->Création de questions<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/installation/" aria-label="Installation"><!--[--><!--[--><!--]--><!--]-->Installation<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/details-techniques/" aria-label="Détails techniques"><!--[--><!--[--><!--]--><!--]-->Détails techniques<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/dev/" aria-label="Dev"><!--[--><!--[--><!--]--><!--]-->Dev<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="Accueil"><!--[--><!--[--><!--]--><!--]-->Accueil<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/utilisation/" aria-label="Utilisation de l&#39;appli"><!--[--><!--[--><!--]--><!--]-->Utilisation de l&#39;appli<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/questions-yaml/" aria-label="Création de questions"><!--[--><!--[--><!--]--><!--]-->Création de questions<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/installation/" aria-label="Installation"><!--[--><!--[--><!--]--><!--]-->Installation<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/details-techniques/" aria-label="Détails techniques"><!--[--><!--[--><!--]--><!--]-->Détails techniques<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/dev/" aria-label="Dev"><!--[--><!--[--><!--]--><!--]-->Dev<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading active">Détails techniques (utilisateurs avancés seulement) <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link route-link-active auto-link vp-sidebar-item" href="/details-techniques/" aria-label="Détails techniques (utilisateurs avancés seulement)"><!--[--><!--[--><!--]--><!--]-->Détails techniques (utilisateurs avancés seulement)<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link route-link-active auto-link vp-sidebar-item active" href="/details-techniques/architecture.html" aria-label="Architecture générale"><!--[--><!--[--><!--]--><!--]-->Architecture générale<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/details-techniques/database.html" aria-label="Base de données"><!--[--><!--[--><!--]--><!--]-->Base de données<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/details-techniques/scoring.html" aria-label="Système de scoring"><!--[--><!--[--><!--]--><!--]-->Système de scoring<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/details-techniques/backend-services.html" aria-label="Services backend"><!--[--><!--[--><!--]--><!--]-->Services backend<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/details-techniques/api.html" aria-label="API REST"><!--[--><!--[--><!--]--><!--]-->API REST<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/details-techniques/configuration.html" aria-label="Configuration et environnement"><!--[--><!--[--><!--]--><!--]-->Configuration et environnement<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/details-techniques/tests.html" aria-label="Tests et qualité"><!--[--><!--[--><!--]--><!--]-->Tests et qualité<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/details-techniques/deployement.html" aria-label="Déploiement et DevOps"><!--[--><!--[--><!--]--><!--]-->Déploiement et DevOps<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/details-techniques/security.html" aria-label="Security Documentation"><!--[--><!--[--><!--]--><!--]-->Security Documentation<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/details-techniques/performance-monitoring.html" aria-label="Performance &amp; Monitoring"><!--[--><!--[--><!--]--><!--]-->Performance &amp; Monitoring<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/details-techniques/troubleshooting.html" aria-label="Troubleshooting Guide"><!--[--><!--[--><!--]--><!--]-->Troubleshooting Guide<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/details-techniques/question-editor.html" aria-label="Éditeur de Questions pour Enseignants"><!--[--><!--[--><!--]--><!--]-->Éditeur de Questions pour Enseignants<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/details-techniques/landing-page.html" aria-label="Landing Page Variants (App)"><!--[--><!--[--><!--]--><!--]-->Landing Page Variants (App)<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div vp-content><!--[--><!--]--><div id="content"><h1 id="architecture-generale" tabindex="-1"><a class="header-anchor" href="#architecture-generale"><span>Architecture générale</span></a></h1><h2 id="vue-d-ensemble-de-l-architecture" tabindex="-1"><a class="header-anchor" href="#vue-d-ensemble-de-l-architecture"><span>Vue d&#39;ensemble de l&#39;architecture</span></a></h2><p>MathQuest suit une architecture moderne full-stack avec séparation claire des responsabilités :</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐</span>
<span class="line">│   Frontend      │    │    Backend      │    │   Database      │</span>
<span class="line">│   (Next.js)     │◄──►│   (Node.js)     │◄──►│  (PostgreSQL)   │</span>
<span class="line">│                 │    │                 │    │                 │</span>
<span class="line">│ - React/TSX     │    │ - Express       │    │ - Prisma ORM    │</span>
<span class="line">│ - Socket.IO     │    │ - Socket.IO     │    │ - GameTemplate  │</span>
<span class="line">│ - Responsive    │    │ - REST API      │    │ - GameInstance  │</span>
<span class="line">│ - PWA ready     │    │ - Services      │    │ - User          │</span>
<span class="line">└─────────────────┘    └─────────────────┘    └─────────────────┘</span>
<span class="line">       │                       │                       │</span>
<span class="line">       └───────────────────────┼───────────────────────┘</span>
<span class="line">                               │</span>
<span class="line">                    ┌─────────────────┐</span>
<span class="line">                    │     Redis       │</span>
<span class="line">                    │   (Cache)       │</span>
<span class="line">                    │                 │</span>
<span class="line">                    │ - Sessions      │</span>
<span class="line">                    │ - Timers        │</span>
<span class="line">                    │ - Game state    │</span>
<span class="line">                    └─────────────────┘</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="architecture-detaillee" tabindex="-1"><a class="header-anchor" href="#architecture-detaillee"><span>Architecture détaillée</span></a></h2><h3 id="frontend-next-js" tabindex="-1"><a class="header-anchor" href="#frontend-next-js"><span>Frontend (Next.js)</span></a></h3><p>Le frontend est organisé selon une structure modulaire :</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">frontend/src/</span>
<span class="line">├── app/              # Pages Next.js 13+ (App Router)</span>
<span class="line">├── components/       # Composants React réutilisables</span>
<span class="line">├── hooks/           # Hooks personnalisés (Socket, Auth, etc.)</span>
<span class="line">├── contexts/        # Contextes React (Auth, Game, etc.)</span>
<span class="line">├── types/           # Types TypeScript</span>
<span class="line">├── utils/           # Utilitaires</span>
<span class="line">└── config/          # Configuration</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Technologies clés :</strong></p><ul><li><strong>Next.js 13+</strong> avec App Router</li><li><strong>React 18</strong> avec hooks et Server Components</li><li><strong>TypeScript</strong> pour le typage strict</li><li><strong>Tailwind CSS</strong> pour le styling</li><li><strong>Socket.IO Client</strong> pour la communication temps réel</li><li><strong>React Query</strong> pour la gestion des données</li></ul><h3 id="catalogue-des-composants-react" tabindex="-1"><a class="header-anchor" href="#catalogue-des-composants-react"><span>Catalogue des composants React</span></a></h3><p>Le frontend utilise une bibliothèque de composants organisée par fonctionnalité :</p><h4 id="navigation-layout" tabindex="-1"><a class="header-anchor" href="#navigation-layout"><span>Navigation &amp; Layout</span></a></h4><ul><li><strong>AppNav.tsx</strong> : Barre de navigation principale, responsive, supporte tous les états d&#39;authentification</li><li><strong>AuthProvider.tsx</strong> : Fournit le contexte d&#39;authentification pour utilisateurs anonymes, invités, élèves et professeurs</li><li><strong>TeacherDashboardLayout.tsx</strong> : Layout du dashboard professeur</li><li><strong>LobbyLayout.tsx</strong> : Layout de la salle d&#39;attente des tournois</li></ul><h4 id="interfaces-de-jeu-quiz" tabindex="-1"><a class="header-anchor" href="#interfaces-de-jeu-quiz"><span>Interfaces de jeu &amp; quiz</span></a></h4><ul><li><strong>Scoreboard.tsx</strong> : Affiche le classement des joueurs en temps réel</li><li><strong>ClassementPodium.tsx</strong> : Podium pour les 3 meilleurs joueurs</li><li><strong>QuestionDisplay.tsx</strong> : Affiche une question de quiz/tournoi (format canonique)</li><li><strong>QuestionCard.tsx</strong> : Carte interactive pour les questions de quiz/tournoi</li><li><strong>TournamentQuestionCard.tsx</strong> : Carte spécialisée pour les questions de tournoi</li><li><strong>DraggableQuestionsList.tsx</strong> : Dashboard professeur, gestion drag-and-drop des questions</li><li><strong>SortableQuestion.tsx</strong> : Question individuelle draggable pour réordonnancement</li><li><strong>QuestionSelector.tsx</strong> : Sélection/filtrage des questions pour quiz/tournois</li><li><strong>QuizList.tsx</strong> : Liste des quiz disponibles</li><li><strong>TournamentTimer.tsx</strong> : Chronomètre pour les questions de tournoi</li><li><strong>AnswerFeedbackOverlay.tsx</strong> : Affiche le feedback après réponse</li><li><strong>GoodAnswer.tsx / WrongAnswer.tsx</strong> : Icônes animées de feedback correct/incorrect</li><li><strong>TeacherDashboardClient.tsx</strong> : Interface client du dashboard professeur</li><li><strong>TeacherProjectionClient.tsx</strong> : Interface de projection pour les enseignants</li></ul><h4 id="composants-ui-utilitaires" tabindex="-1"><a class="header-anchor" href="#composants-ui-utilitaires"><span>Composants UI &amp; utilitaires</span></a></h4><ul><li><strong>Snackbar.tsx</strong> : Notifications toast pour le feedback utilisateur</li><li><strong>ConfirmationModal.tsx / ConfirmDialog.tsx</strong> : Dialogues modaux de confirmation et avertissement</li><li><strong>CustomDropdown.tsx / MultiSelectDropdown.tsx / EnhancedMultiSelectDropdown.tsx</strong> : Dropdowns personnalisés (multi-)sélection</li><li><strong>AvatarSelector.tsx / ui/AvatarGrid.tsx</strong> : Grilles de sélection d&#39;avatar pour profils</li><li><strong>MathJaxWrapper.tsx</strong> : Rendu LaTeX/MathJax dans les questions et explications</li><li><strong>ZoomControls.tsx</strong> : Contrôles UI pour zoomer le contenu</li><li><strong>Trophy.tsx</strong> : Icône animée de trophée pour récompenses</li><li><strong>InfinitySpin.tsx</strong> : Spinner de chargement animé</li><li><strong>CodeManager.tsx</strong> : Gestion de génération et mise à jour des codes tournoi/quiz</li><li><strong>LoadingScreen.tsx</strong> : Écran de chargement</li><li><strong>ErrorBoundary.tsx</strong> : Gestionnaire d&#39;erreurs React</li><li><strong>StatisticsChart.tsx / StatisticsChartImpl.tsx</strong> : Graphiques de statistiques</li><li><strong>QrCodeWithLogo.tsx</strong> : Génération de QR codes avec logo</li></ul><h4 id="profil-authentification" tabindex="-1"><a class="header-anchor" href="#profil-authentification"><span>Profil &amp; authentification</span></a></h4><ul><li><strong>profile/ProfileForm.tsx</strong> : Formulaire d&#39;édition de profil utilisateur</li><li><strong>profile/AccountUpgradeForm.tsx / TeacherUpgradeForm.tsx</strong> : Flux de mise à niveau de compte</li><li><strong>auth/GuestForm.tsx / GuestUpgradeForm.tsx / StudentAuthForm.tsx</strong> : Formulaires d&#39;authentification et inscription</li><li><strong>auth/AuthModeToggle.tsx</strong> : Bascule entre modes d&#39;authentification</li><li><strong>AuthErrorBanner.tsx</strong> : Bannière d&#39;erreur d&#39;authentification</li></ul><h4 id="tests" tabindex="-1"><a class="header-anchor" href="#tests"><span>Tests</span></a></h4><ul><li><strong><strong>tests</strong>/</strong> : Tests unitaires des composants (ex: AppNav, BasicButton)</li></ul><p><em>Pour les props détaillées et l&#39;utilisation, voir le code source dans <code>frontend/src/components/</code> et sous-dossiers.</em></p><h3 id="backend-node-js" tabindex="-1"><a class="header-anchor" href="#backend-node-js"><span>Backend (Node.js)</span></a></h3><p>Le backend suit une architecture en couches avec séparation des responsabilités :</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">backend/src/</span>
<span class="line">├── api/             # Routes REST API</span>
<span class="line">├── sockets/         # Gestionnaires Socket.IO</span>
<span class="line">├── core/            # Services métier</span>
<span class="line">│   ├── services/    # Services (Scoring, Timer, etc.)</span>
<span class="line">│   └── models/      # Modèles de données</span>
<span class="line">├── db/              # Accès base de données (Prisma)</span>
<span class="line">├── middleware/      # Middlewares Express</span>
<span class="line">└── utils/           # Utilitaires</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Technologies clés :</strong></p><ul><li><strong>Node.js</strong> avec TypeScript</li><li><strong>Express.js</strong> pour l&#39;API REST</li><li><strong>Socket.IO</strong> pour la communication temps réel</li><li><strong>Prisma</strong> comme ORM</li><li><strong>Redis</strong> pour le cache et les sessions</li><li><strong>JWT</strong> pour l&#39;authentification</li></ul><h3 id="base-de-donnees-postgresql" tabindex="-1"><a class="header-anchor" href="#base-de-donnees-postgresql"><span>Base de données (PostgreSQL)</span></a></h3><p>La base de données utilise PostgreSQL avec Prisma comme ORM :</p><ul><li><strong>GameTemplate</strong> : Modèles de quiz/tournois</li><li><strong>GameInstance</strong> : Instances de parties en cours</li><li><strong>User</strong> : Utilisateurs (élèves/professeurs)</li><li><strong>Question</strong> : Questions (QCM, numériques)</li><li><strong>GameParticipant</strong> : Participants aux parties</li></ul><h3 id="communication-temps-reel" tabindex="-1"><a class="header-anchor" href="#communication-temps-reel"><span>Communication temps réel</span></a></h3><p>MathQuest utilise Socket.IO pour la communication bidirectionnelle :</p><ul><li><strong>Événements client→serveur</strong> : Réponses aux questions, rejoindre une partie</li><li><strong>Événements serveur→client</strong> : Mise à jour du leaderboard, nouvelle question</li><li><strong>Rooms Socket.IO</strong> : Isolation des parties par code d&#39;accès</li></ul><h3 id="cache-et-sessions-redis" tabindex="-1"><a class="header-anchor" href="#cache-et-sessions-redis"><span>Cache et sessions (Redis)</span></a></h3><p>Redis est utilisé pour :</p><ul><li><strong>Sessions utilisateur</strong> : Gestion des sessions authentifiées</li><li><strong>État des parties</strong> : Stockage temporaire de l&#39;état des quiz</li><li><strong>Timers</strong> : Gestion des chronomètres côté serveur</li><li><strong>Cache des questions</strong> : Amélioration des performances</li></ul><h3 id="generation-pdf-des-questions-scripts-yaml2latex-py" tabindex="-1"><a class="header-anchor" href="#generation-pdf-des-questions-scripts-yaml2latex-py"><span>Génération PDF des questions (<code>scripts/yaml2latex.py</code>)</span></a></h3><p>Le script <code>scripts/yaml2latex.py</code> permet de transformer les fichiers YAML des dossiers <code>questions/</code> en PDF de relecture. Depuis la refonte 2025-09-27 :</p><ul><li>Chaque exercice affiche un lien cliquable sur son <code>uid</code> qui pointe directement vers le fichier YAML d&#39;origine.</li><li>Les liens utilisent des URI <code>file://</code> compatibles Windows. Sous WSL, le chemin est automatiquement converti en <code>file://wsl.localhost/&lt;distro&gt;/…</code>, ce qui évite tout recours à des scripts <code>.bat</code> intermédiaires.</li><li>Le numéro de ligne du bloc YAML est indiqué après le titre afin de faciliter la navigation une fois le fichier ouvert.</li><li>Lors de l&#39;exécution, le script nettoie les anciens dossiers <code>open-in-vscode/</code> générés par les versions précédentes pour éviter les résidus.</li><li>Les PDF ouverts avec un lecteur autorisant les liens de fichiers (SumatraPDF, Edge, etc.) ouvrent ainsi le YAML dans l&#39;éditeur par défaut configuré côté Windows.</li></ul><p>⚠️ Selon la politique de sécurité de votre lecteur PDF, vous devrez peut-être autoriser explicitement l&#39;ouverture des liens <code>file://</code>.</p><h2 id="types-partages-shared-types" tabindex="-1"><a class="header-anchor" href="#types-partages-shared-types"><span>Types partagés (Shared Types)</span></a></h2><p>MathQuest utilise un système de types partagés centralisés dans <code>shared/types/</code> pour assurer la cohérence entre frontend et backend.</p><h3 id="structure-des-types-partages" tabindex="-1"><a class="header-anchor" href="#structure-des-types-partages"><span>Structure des types partagés</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">shared/types/</span>
<span class="line">├── index.ts              # Point d&#39;entrée principal</span>
<span class="line">├── question.ts           # Types de base des questions</span>
<span class="line">├── quiz/                 # Types liés aux quiz</span>
<span class="line">│   ├── question.ts       # Types étendus des questions</span>
<span class="line">│   ├── state.ts          # États des quiz</span>
<span class="line">│   └── liveQuestion.ts   # Questions en direct</span>
<span class="line">├── socket/               # Types liés aux sockets</span>
<span class="line">│   ├── events.ts         # Constantes des événements socket</span>
<span class="line">│   └── payloads.ts       # Payloads des événements socket</span>
<span class="line">├── tournament/           # Types liés aux tournois</span>
<span class="line">│   ├── participant.ts    # Types des participants</span>
<span class="line">│   └── state.ts          # États des tournois</span>
<span class="line">├── util/                 # Utilitaires de types</span>
<span class="line">│   ├── logger.ts         # Interface des loggers</span>
<span class="line">│   ├── typeGuards.ts     # Guards de types</span>
<span class="line">│   ├── typeErrors.ts     # Gestion des erreurs</span>
<span class="line">│   ├── typeMapping.ts    # Conversions de types</span>
<span class="line">│   ├── schemaValidation.ts # Validation des schémas</span>
<span class="line">│   └── schemaDefinitions.ts # Définitions des schémas</span>
<span class="line">└── examples/             # Exemples d&#39;utilisation</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="utilisation-des-types-partages" tabindex="-1"><a class="header-anchor" href="#utilisation-des-types-partages"><span>Utilisation des types partagés</span></a></h3><p>Importez les types partagés avec l&#39;alias <code>@shared/types</code> :</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code class="language-typescript"><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> </span>
<span class="line">  Question<span class="token punctuation">,</span> </span>
<span class="line">  Answer<span class="token punctuation">,</span> </span>
<span class="line">  <span class="token constant">GAME_EVENTS</span><span class="token punctuation">,</span> </span>
<span class="line">  isQuestion<span class="token punctuation">,</span></span>
<span class="line">  mapToStandardQuestion </span>
<span class="line"><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@shared/types&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="outils-de-validation-des-types" tabindex="-1"><a class="header-anchor" href="#outils-de-validation-des-types"><span>Outils de validation des types</span></a></h3><p>Les types partagés incluent plusieurs outils pour la validation runtime :</p><ul><li><strong>Type Guards</strong> : Fonctions comme <code>isQuestion</code> pour la vérification basique des types</li><li><strong>Type Mapping</strong> : Fonctions comme <code>mapToStandardQuestion</code> pour convertir entre formats</li><li><strong>Schema Validation</strong> : Utilitaires de validation pour les exigences complexes</li></ul><h3 id="evenements-socket-io-canoniques" tabindex="-1"><a class="header-anchor" href="#evenements-socket-io-canoniques"><span>Événements Socket.IO canoniques</span></a></h3><p>Tous les événements Socket.IO sont définis dans <code>shared/types/socket/events.ts</code> :</p><ul><li><strong>TEACHER_EVENTS</strong> : Événements du tableau de bord enseignant</li><li><strong>GAME_EVENTS</strong> : Événements de jeu/quiz (flux unifié)</li><li><strong>TOURNAMENT_EVENTS</strong> : Événements spécifiques aux tournois</li><li><strong>PROJECTOR_EVENTS</strong> : Événements de projection</li><li><strong>LOBBY_EVENTS</strong> : Événements de lobby (dépréciés)</li></ul><p>Voir la section &quot;Événements Socket.IO&quot; dans <code>backend-services.md</code> pour la documentation complète.</p><h2 id="flux-de-donnees-typique" tabindex="-1"><a class="header-anchor" href="#flux-de-donnees-typique"><span>Flux de données typique</span></a></h2><h3 id="creation-d-un-quiz" tabindex="-1"><a class="header-anchor" href="#creation-d-un-quiz"><span>Création d&#39;un quiz</span></a></h3><ol><li><strong>Frontend</strong> : Utilisateur crée un GameTemplate</li><li><strong>Backend</strong> : Validation et sauvegarde en base</li><li><strong>Database</strong> : Stockage du template avec questions associées</li></ol><h3 id="demarrage-d-un-quiz" tabindex="-1"><a class="header-anchor" href="#demarrage-d-un-quiz"><span>Démarrage d&#39;un quiz</span></a></h3><ol><li><strong>Frontend</strong> : Professeur lance le quiz</li><li><strong>Backend</strong> : Création d&#39;une GameInstance</li><li><strong>Socket.IO</strong> : Notification à tous les participants</li><li><strong>Redis</strong> : Initialisation des timers et état de partie</li></ol><h3 id="reponse-a-une-question" tabindex="-1"><a class="header-anchor" href="#reponse-a-une-question"><span>Réponse à une question</span></a></h3><ol><li><strong>Frontend</strong> : Élève soumet sa réponse</li><li><strong>Socket.IO</strong> : Transmission au backend</li><li><strong>Backend</strong> : Validation et calcul du score</li><li><strong>Database</strong> : Mise à jour du score du participant</li><li><strong>Socket.IO</strong> : Diffusion du leaderboard mis à jour</li></ol><h2 id="securite" tabindex="-1"><a class="header-anchor" href="#securite"><span>Sécurité</span></a></h2><ul><li><strong>Authentification JWT</strong> avec refresh tokens</li><li><strong>Validation des entrées</strong> avec Zod schemas</li><li><strong>Rate limiting</strong> sur les API</li><li><strong>CORS</strong> configuré pour les origines autorisées</li><li><strong>HTTPS</strong> obligatoire en production</li></ul><h2 id="performance" tabindex="-1"><a class="header-anchor" href="#performance"><span>Performance</span></a></h2><ul><li><strong>Cache Redis</strong> pour les données fréquemment accédées</li><li><strong>Lazy loading</strong> des composants React</li><li><strong>Optimisation des images</strong> avec Next.js</li><li><strong>Compression</strong> des réponses HTTP</li><li><strong>Pooling de connexions</strong> base de données</li></ul></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">Dernière mise à jour: </span><time class="meta-item-info" datetime="2025-10-29T13:41:44.000Z" data-allow-mismatch>29/10/2025 14:41</time></div><div class="vp-meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: alexis.flesch@gmail.com">alexisflesch</span><!----><!--]--><!--]--></span></div></div></footer><nav class="vp-page-nav" aria-label="page navigation"><a class="route-link route-link-active auto-link prev" href="/details-techniques/" aria-label="Détails techniques (utilisateurs avancés seulement)"><!--[--><div class="hint"><span class="arrow left"></span> Prev</div><div class="link"><span class="external-link">Détails techniques (utilisateurs avancés seulement)</span></div><!--]--></a><a class="route-link auto-link next" href="/details-techniques/database.html" aria-label="Base de données"><!--[--><div class="hint">Next <span class="arrow right"></span></div><div class="link"><span class="external-link">Base de données</span></div><!--]--></a></nav><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-Blvv7Pu1.js" defer></script>
  </body>
</html>
