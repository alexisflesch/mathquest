/* mathjax-overrides.css

   Purpose: keep MathJax-specific layout overrides in one small file so
   `globals.css` stays manageable. These rules are narrowly scoped to
   question display containers (.question-text-in-live-page and
   .question-text-in-dashboards) and target MathJax display-mode and
   container elements which can introduce fractional/rounded heights
   resulting in unwanted vertical scrollbars inside question cards.

   Approach: Prefer letting MathJax expand vertically (overflow-y: visible)
   while allowing horizontal scrolling for wide formulas (overflow-x: auto).
   This avoids clipping content while removing internal vertical scrollbars.
*/

/* Narrow scope: question text in live pages
   IMPORTANT: avoid applying to every descendant (no "*") because MathJax
   creates many internal boxes; setting overflow on every inner node
   produces nested scrollbars. Instead, target only the outer wrapper and
   the MathJax container elements, then force inner MathJax children to
   remain visible (no scroll) so only the outer element can scroll.
*/
.card.w-full.max-w-2xl .tqcard-content .question-text-in-live-page {
    /* allow horizontal scrolling for wide formulas, allow vertical expansion */
    overflow-x: auto !important;
    overflow-y: visible !important;
    max-height: none !important;
}

/* MathJax display-mode and block wrappers (\[ ... \]) */
.card.w-full.max-w-2xl .tqcard-content .question-text-in-live-page .MathJax_Display,
.card.w-full.max-w-2xl .tqcard-content .question-text-in-live-page .mjx-block,
.card.w-full.max-w-2xl .tqcard-content .question-text-in-live-page mjx-container,
.card.w-full.max-w-2xl .tqcard-content .question-text-in-live-page .mjx-chtml,
.card.w-full.max-w-2xl .tqcard-content .question-text-in-live-page .MathJax {
    /* IMPORTANT: do not create horizontal scrollbars on inner wrappers. Let the outer container scroll. */
    overflow-x: visible !important;
    overflow-y: visible !important;
    max-height: none !important;
}

/* Prevent nested MathJax children from becoming scrollable. Target inner
   rendered nodes inside the MathJax / mjx-chtml wrappers so glyph boxes
   don't get their own scrollbars. */
.card.w-full.max-w-2xl .tqcard-content .question-text-in-live-page .MathJax *,
.card.w-full.max-w-2xl .tqcard-content .question-text-in-live-page .mjx-chtml * {
    overflow: visible !important;
}

/* Apply same treatment to dashboard/tournament variants */
.card.w-full.max-w-2xl .tqcard-content .question-text-in-dashboards {
    overflow-x: auto !important;
    overflow-y: visible !important;
    max-height: none !important;
}

.card.w-full.max-w-2xl .tqcard-content .question-text-in-dashboards .MathJax_Display,
.card.w-full.max-w-2xl .tqcard-content .question-text-in-dashboards mjx-container,
.card.w-full.max-w-2xl .tqcard-content .question-text-in-dashboards .mjx-chtml,
.card.w-full.max-w-2xl .tqcard-content .question-text-in-dashboards .MathJax {
    overflow-x: visible !important;
    overflow-y: visible !important;
    max-height: none !important;
}

.card.w-full.max-w-2xl .tqcard-content .question-text-in-dashboards .MathJax *,
.card.w-full.max-w-2xl .tqcard-content .question-text-in-dashboards .mjx-chtml * {
    overflow: visible !important;
}

/* MathJax inside answer buttons (multiple-choice answers)
   The answers render MathJax inside buttons with class `tqcard-answer`.
   Ensure MathJax containers inside answers can expand vertically and
   that inner MathJax children don't create nested scrollbars. */
.card.w-full.max-w-2xl .tqcard-content .tqcard-answer .MathJax,
.card.w-full.max-w-2xl .tqcard-content .tqcard-answer mjx-container,
.card.w-full.max-w-2xl .tqcard-content .tqcard-answer .mjx-chtml,
.card.w-full.max-w-2xl .tqcard-content .tqcard-answer .MathJax {
    /* Answers already have overflow-x on the button; avoid inner scrollbars. */
    overflow-x: visible !important;
    overflow-y: visible !important;
    max-height: none !important;
}

.card.w-full.max-w-2xl .tqcard-content .tqcard-answer .MathJax *,
.card.w-full.max-w-2xl .tqcard-content .tqcard-answer .mjx-chtml * {
    overflow: visible !important;
}

/* Global helper wrapper for MathJax (added by assistant):
   This class is added to the wrapper component so we can always
   target MathJax output reliably and prevent vertical clipping. */
.mq-mathjax-wrapper .MathJax_Display,
.mq-mathjax-wrapper .mjx-block,
.mq-mathjax-wrapper mjx-container,
.mq-mathjax-wrapper .mjx-chtml,
.mq-mathjax-wrapper .MathJax {
    overflow-x: visible !important;
    overflow-y: visible !important;
    max-height: none !important;
}

.mq-mathjax-wrapper .MathJax *,
.mq-mathjax-wrapper .mjx-chtml * {
    overflow: visible !important;
}

/* Force mjx-container to size to its content inside question cards and answers.
    MathJax sometimes sets internal scroll regions; this rule forces the container
    to grow vertically so scrollHeight == clientHeight and no scrollbar appears.
    (kept intentionally narrow and component-scoped) */

/* Rendering smoothing + GPU hints
   When the preview UI scales the student card via `transform: scale(...)`, some
   browsers produce subtle vertical aliasing/seam artifacts on tall, stretchy
   delimiters (parentheses/brackets). The rules below enable font-smoothing and
   force GPU compositing on the MathJax render tree to reduce those seams.
   These are narrow and only apply to MathJax output contained in the stable
   wrapper class added to the MathJax component. */
.mq-mathjax-wrapper,
.mq-mathjax-wrapper .mjx-chtml,
.mq-mathjax-wrapper .MathJax {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    /* Keep smoothing but avoid forcing separate compositing layers which
       can cause thin seam artifacts when the parent is scaled. */
}