ðŸ” Socket Payload Validator - Project root: /home/aflesch/mathquest/app
ðŸ“‚ Loading files from: shared
ðŸ“‚ Loading files from: backend/src
ðŸ“‚ Loading files from: frontend/src
âœ… Loaded 895 TypeScript files
ðŸ“‹ Loading shared references...
âœ… Found 265 shared types
âœ… Found 6 socket event constants
âœ… Found 202 Zod schemas
ðŸ” Starting Socket Payload Validation Analysis...\n
ðŸ” Finding socket handlers...
âœ… Found 26 socket handlers
ðŸ” Finding socket emitters...
âœ… Found 100 socket emitters
ðŸ” Analyzing payload validation patterns...
ðŸ” Checking shared type usage...
ðŸ” Validating naming consistency...
ðŸ’¡ Generating recommendations...
\nðŸ“Š SOCKET PAYLOAD VALIDATION RESULTS\n
============================================================
\nðŸ“ˆ SUMMARY:
   Socket Handlers: 26
   Socket Emitters: 100
   Total Issues: 282
   Shared Types Available: 265
\nðŸ”´ ISSUES FOUND:
\n   MISSINGZODVALIDATION (7 issues):
   â€¢ backend/src/sockets/handlers/connectionHandlers.ts:20 - Missing Zod schema validation
     Event: connection
   â€¢ backend/src/tests/unit/participantCount.test.ts:29 - Missing Zod schema validation
     Event: connection
   â€¢ backend/src/tests/unit/participantCount.test.ts:51 - Missing Zod schema validation
     Event: connection
   â€¢ backend/src/tests/unit/participantCount.test.ts:52 - Missing Zod schema validation
     Event: join-room
   â€¢ frontend/src/app/teacher/dashboard/[code]/page.tsx:186 - Missing Zod schema validation
     Event: quiz_connected_count
   ... and 2 more
\n   HARDCODEDEVENTNAMES (126 issues):
   â€¢ frontend/src/hooks/useGameSocket.ts:316 - Hardcoded event name instead of SOCKET_EVENTS constant
     Event: game_joined
   â€¢ frontend/src/hooks/useGameSocket.ts:371 - Hardcoded event name instead of SOCKET_EVENTS constant
     Event: timer_update
   â€¢ frontend/src/hooks/usePracticeSession.ts:354 - Hardcoded event name instead of SOCKET_EVENTS constant
     Event: correct_answers
   â€¢ frontend/src/hooks/usePracticeSession.ts:385 - Hardcoded event name instead of SOCKET_EVENTS constant
     Event: feedback
   â€¢ frontend/src/hooks/useStudentGameSocket.ts:234 - Hardcoded event name instead of SOCKET_EVENTS constant
     Event: game_joined
   ... and 121 more
\n   UNSHAREDPAYLOADTYPES (97 issues):
   â€¢ frontend/src/hooks/useStudentGameSocket.ts:386 - Uses local type instead of shared type
     Event: game_ended
     Type: string; endedAt?: string; score?: number; totalQuestions?: number; correct?: number; total?: number }>((payload
   â€¢ backend/src/sockets/handlers/connectionHandlers.ts:20 - Uses local type instead of shared type
     Event: connection
     Type: Socket<ClientToServerEvents
   â€¢ frontend/src/app/teacher/dashboard/[code]/page.tsx:186 - Uses local type instead of shared type
     Event: quiz_connected_count
     Type: { count: number }
   â€¢ frontend/src/hooks/useStudentGameSocket.ts:458 - Emitter not using shared payload types
     Event: request_next_question
   â€¢ frontend/src/hooks/useTeacherQuizSocket.ts:162 - Emitter not using shared payload types
     Event: end_game
   ... and 92 more
\n   MISSINGTYPEGUARDS (5 issues):
   â€¢ frontend/src/hooks/usePracticeSession.ts:354 - Missing runtime type validation
     Event: correct_answers
   â€¢ frontend/src/hooks/usePracticeSession.ts:385 - Missing runtime type validation
     Event: feedback
   â€¢ backend/src/tests/unit/participantCount.test.ts:29 - Missing runtime type validation
     Event: connection
   â€¢ backend/src/tests/unit/participantCount.test.ts:51 - Missing runtime type validation
     Event: connection
   â€¢ backend/src/tests/unit/participantCount.test.ts:52 - Missing runtime type validation
     Event: join-room
\n   UNDOCUMENTEDEVENTS (26 issues):
   â€¢ frontend/src/hooks/useGameSocket.ts:316 - Socket handler not documented
     Event: game_joined
   â€¢ frontend/src/hooks/useGameSocket.ts:371 - Socket handler not documented
     Event: timer_update
   â€¢ frontend/src/hooks/usePracticeSession.ts:354 - Socket handler not documented
     Event: correct_answers
   â€¢ frontend/src/hooks/usePracticeSession.ts:385 - Socket handler not documented
     Event: feedback
   â€¢ frontend/src/hooks/useStudentGameSocket.ts:234 - Socket handler not documented
     Event: game_joined
   ... and 21 more
\n   ANYTYPEDPAYLOADS (21 issues):
   â€¢ frontend/src/hooks/useGameSocket.ts:316 - Payload typed as any
     Event: game_joined
   â€¢ frontend/src/hooks/useGameSocket.ts:371 - Payload typed as any
     Event: timer_update
   â€¢ frontend/src/hooks/useStudentGameSocket.ts:234 - Payload typed as any
     Event: game_joined
   â€¢ frontend/src/hooks/useStudentGameSocket.ts:241 - Payload typed as any
     Event: game_question
   â€¢ frontend/src/hooks/useStudentGameSocket.ts:269 - Payload typed as any
     Event: game_state_update
   ... and 16 more
\nðŸ’¡ RECOMMENDATIONS:
\n1. ðŸ”´ HIGH: Add Zod validation to 7 socket handlers
   Socket handlers should validate incoming payloads with Zod schemas
   Action: Import and use appropriate Zod schemas from @shared/types/socketEvents.zod
\n2. ðŸŸ¡ MEDIUM: Replace 126 hardcoded event names
   Use SOCKET_EVENTS constants instead of hardcoded strings
   Action: Import SOCKET_EVENTS from @shared/types/socket/events and use constants
\n3. ðŸ”´ HIGH: Convert 97 local types to shared types
   Socket payloads should use canonical shared types
   Action: Replace local interface definitions with imports from @shared/types
\n============================================================
Analysis completed at: 2025-06-20T13:25:16.315Z
\nâš ï¸  Found 282 issues that need attention.
